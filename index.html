<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate Conversion Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
        }
        .calculator-container {
            max-width: 600px;
            margin: 20px auto;
            padding: 24px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h3 {
            color: #0077b5;
            text-align: center;
            margin-bottom: 8px;
        }
        p.description {
            text-align: center;
            color: #555;
            margin-bottom: 24px;
        }
        .input-group {
            margin-bottom: 16px;
        }
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #333;
        }
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        button {
            width: 100%;
            padding: 12px;
            background-color: #0077b5;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }
        button:hover {
            background-color: #005f99;
            transform: translateY(-1px);
        }
        .results-container {
            margin-top: 24px;
            border-top: 2px solid #eee;
            padding-top: 24px;
        }
        .results-section {
            margin-bottom: 20px;
            padding: 16px;
            background-color: #f9fbfd;
            border-radius: 8px;
        }
        .results-section h4 {
            color: #0077b5;
            margin-top: 0;
        }
        .results-section ul {
            list-style-type: none;
            padding-left: 0;
        }
        .results-section li {
            margin-bottom: 8px;
            color: #444;
        }
        .comparison-section {
            background-color: #e7f5ff;
        }
        .comparison-section li {
            font-weight: bold;
        }
        .error-message {
            color: #d9534f;
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
        }
        #salesChartContainer {
            position: relative;
            margin-top: 20px;
            max-height: 400px;
            padding-bottom: 10px;
        }
        #salesChart {
            height: 400px;
            width: 600px;
            margin: 0 auto; /* Center the chart */
        }
    </style>
</head>
<body>

<div class="calculator-container">
    <h3>Real Estate Sales & Marketing Calculator</h3>
    <p class="description">Run your own numbers to see the impact of an improved sales conversion rate on your project's sales velocity and gross sales value. Now includes marketing cost and team performance metrics!</p>
  
    <div class="input-group">
        <label for="leads">Number of New Leads per Month:</label>
        <input type="number" id="leads" value="750" placeholder="e.g., 750">
    </div>
  
    <div class="input-group">
        <label for="units">Number of Units in Building:</label>
        <input type="number" id="units" value="300" placeholder="e.g., 300">
    </div>
  
    <div class="input-group">
        <label for="price">Average Unit Price (in PHP):</label>
        <input type="number" id="price" value="9000000" placeholder="e.g., 9000000">
    </div>
  
    <div class="input-group">
        <label for="costPerLead">Average Cost per Lead (in PHP):</label>
        <input type="number" id="costPerLead" value="500" placeholder="e.g., 500">
    </div>

    <div class="input-group">
        <label for="agents">Number of Sales Agents:</label>
        <input type="number" id="agents" value="10" placeholder="e.g., 10">
    </div>
  
    <div class="input-group">
        <label for="conv1">Typical Conversion Rate (in %):</label>
        <input type="number" id="conv1" value="2" placeholder="e.g., 2">
    </div>
  
    <div class="input-group">
        <label for="conv2">Improved Conversion Rate (in %):</label>
        <input type="number" id="conv2" value="6" placeholder="e.g., 6">
    </div>
  
    <button onclick="calculate()">Calculate Impact</button>
  
    <div id="salesChartContainer">
        <canvas id="salesChart"></canvas>
    </div>

    <div id="results" class="results-container"></div>
</div>

<script>
let myChart; // Variable to hold the chart instance

function formatCurrency(number) {
    if (isNaN(number) || !isFinite(number)) {
        return 'N/A';
    }
    return 'PHP ' + new Intl.NumberFormat('en-PH', {
        minimumFractionDigits: 0,
        maximumFractionDigits: 0,
    }).format(number);
}

function calculate() {
    // Get all input values
    const leads = parseFloat(document.getElementById('leads').value);
    const units = parseFloat(document.getElementById('units').value);
    const price = parseFloat(document.getElementById('price').value);
    const costPerLead = parseFloat(document.getElementById('costPerLead').value);
    const agents = parseFloat(document.getElementById('agents').value);
    const conv1 = parseFloat(document.getElementById('conv1').value) / 100;
    const conv2 = parseFloat(document.getElementById('conv2').value) / 100;
    
    // Simple validation for inputs
    if (isNaN(leads) || isNaN(units) || isNaN(price) || isNaN(costPerLead) || isNaN(agents) || isNaN(conv1) || isNaN(conv2) || leads <= 0 || units <= 0 || price <= 0 || costPerLead < 0 || agents <= 0 || conv1 <= 0 || conv2 <= 0) {
        document.getElementById('results').innerHTML = '<p class="error-message">Please enter valid positive numbers for all fields. Cost per lead can be zero.</p>';
        return;
    }

    // Calculations for Scenario 1
    const unitsSold1 = leads * conv1;
    const timeToSell1 = units / unitsSold1;
    const salesValue1 = unitsSold1 * price;
    const totalMarketingCost1 = leads * costPerLead;
    const roi1 = totalMarketingCost1 > 0 ? ((salesValue1 - totalMarketingCost1) / totalMarketingCost1) * 100 : 'N/A';
    const salesPerAgent1 = unitsSold1 / agents;
    const salesValuePerAgent1 = salesValue1 / agents;

    // Calculations for Scenario 2
    const unitsSold2 = leads * conv2;
    const timeToSell2 = units / unitsSold2;
    const salesValue2 = unitsSold2 * price;
    const totalMarketingCost2 = leads * costPerLead;
    const roi2 = totalMarketingCost2 > 0 ? ((salesValue2 - totalMarketingCost2) / totalMarketingCost2) * 100 : 'N/A';
    const salesPerAgent2 = unitsSold2 / agents;
    const salesValuePerAgent2 = salesValue2 / agents;

    // Calculate the difference
    const salesValueDifference = salesValue2 - salesValue1;
    
    // Get the results container
    const resultsDiv = document.getElementById('results');
    
    // Generate the HTML for the results
    resultsDiv.innerHTML = `
        <div class="results-section">
            <h4>Scenario 1: Typical Conversion (${(conv1 * 100).toFixed(1)}%)</h4>
            <ul>
                <li>Units Sold per Month: <strong>${unitsSold1.toFixed(1)}</strong></li>
                <li>Monthly Gross Sales Value: <strong>${formatCurrency(salesValue1)}</strong></li>
                <li>Monthly Marketing Cost: <strong>${formatCurrency(totalMarketingCost1)}</strong></li>
                <li>Units Sold per Agent: <strong>${salesPerAgent1.toFixed(1)}</strong></li>
                <li>Monthly Sales Value per Agent: <strong>${formatCurrency(salesValuePerAgent1)}</strong></li>
            </ul>
        </div>
        
        <div class="results-section">
            <h4>Scenario 2: Improved Conversion (${(conv2 * 100).toFixed(1)}%)</h4>
            <ul>
                <li>Units Sold per Month: <strong>${unitsSold2.toFixed(1)}</strong></li>
                <li>Monthly Gross Sales Value: <strong>${formatCurrency(salesValue2)}</strong></li>
                <li>Monthly Marketing Cost: <strong>${formatCurrency(totalMarketingCost2)}</strong></li>
                <li>Units Sold per Agent: <strong>${salesPerAgent2.toFixed(1)}</strong></li>
                <li>Monthly Sales Value per Agent: <strong>${formatCurrency(salesValuePerAgent2)}</strong></li>
            </ul>
        </div>
        
        <div class="results-section comparison-section">
            <h4>Strategic Takeaway</h4>
            <ul>
                <li>Sales Timeline Reduced: <strong>${(timeToSell1 - timeToSell2).toFixed(1)} months faster</strong></li>
                <li>Monthly Gross Sales Value: <strong>${formatCurrency(salesValueDifference)} higher</strong></li>
                <li>Monthly Sales Per Agent: <strong>${(salesPerAgent2 - salesPerAgent1).toFixed(1)} more units</strong></li>
                <li>Monthly Sales Value Per Agent: <strong>${formatCurrency(salesValuePerAgent2 - salesValuePerAgent1)} higher</strong></li>
            </ul>
        </div>
    `;

    // Now, create the chart
    const ctx = document.getElementById('salesChart').getContext('2d');
    
    // Destroy the previous chart instance if it exists
    if (myChart) {
        myChart.destroy();
    }

    myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [
                `Typical Conversion (${(conv1 * 100).toFixed(1)}%)`, 
                `Improved Conversion (${(conv2 * 100).toFixed(1)}%)`,
                'Difference'
            ],
            datasets: [{
                label: 'Monthly Gross Sales Value',
                data: [salesValue1, salesValue2, salesValueDifference],
                backgroundColor: [
                    'rgba(153, 153, 153, 0.7)',
                    'rgba(0, 119, 181, 0.9)',
                    'rgba(24, 201, 100, 0.9)'
                ],
                borderColor: [
                    'rgba(153, 153, 153, 1)',
                    'rgba(0, 119, 181, 1)',
                    'rgba(24, 201, 100, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: false,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Gross Sales Value (in PHP)'
                    },
                    ticks: {
                        callback: function(value) {
                            return (value / 1000000) + 'M';
                        }
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                title: {
                    display: true,
                    text: 'Monthly Gross Sales Value Comparison'
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += formatCurrency(context.parsed.y);
                            }
                            return label;
                        }
                    }
                }
            }
        }
    });
}
</script>

</body>
</html>
